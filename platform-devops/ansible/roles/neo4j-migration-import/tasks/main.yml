- name: Check if neo4j is running
  become: yes
  become_user: learning
  shell: ps -ef | grep {{neo4j_home}}  | grep -v grep | wc -l
  register: neo4j_process
  tags: 
       - learning
       - language
  

- name: Stop the neo4j
  become: yes
  become_user: learning
  command: chdir={{ neo4j_home }}/bin ./neo4j stop
  when: "neo4j_process.stdout != '0'"
  tags: 
       - learning
       - language

- name: Cleanup
  become: yes
  file: path={{ neo4j_home }}/data/databases/graph.db state=absent
  tags: 
       - learning
       - language
 
- name: create graph.db
  become: yes
  file: path={{ neo4j_home }}/data/databases/graph.db state=directory owner={{user}} group={{user}}
  tags: 
       - learning
       - language

- name: copy all the graph files 
  become: yes
  become_user: learning
  shell: cp -r /home/learning/{{graph_machine}}/* /home/learning/{{ neo4j_dir }}/neo4j-enterprise-3.0.4/data/databases/graph.db/
  tags: 
       - learning
       - language



 